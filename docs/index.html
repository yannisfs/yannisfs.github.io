<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Crystal Spikes Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- GSAP + ScrollTrigger (via CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/ScrollTrigger.min.js"></script>

  <style>
    /* Basic Page Setup */
    html, body {
      margin: 0;
      padding: 0;
      /* Ensure there's enough height for scrolling */
      height: 200vh;
      font-family: sans-serif;
      position: relative;
      overflow-x: hidden;
    }

    h1 {
      text-align: center;
      margin-top: 2rem;
    }

    /* A bit of filler content to scroll through */
    .content {
      width: 80%;
      max-width: 800px;
      margin: 3rem auto;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }

    /* The container that holds the crystal SVG at the bottom */
    .crystal-container {
      position: fixed;
      left: 0;
      bottom: 0;
      width: 100%;
      height: 300px;       /* matches the SVG's coordinate height (viewBox 0..300) */
      z-index: -1;         /* behind the content */
      pointer-events: none;/* clicks pass through */
      overflow: visible;   /* in case we animate them upwards */
    }

    /* Make the inline SVG fill the containerâ€™s width and height */
    #crystal-svg {
      display: block;
      width: 100%;
      height: 100%;
      /* Ensures bottom alignment within the 300px container */
      preserveAspectRatio: xMidYMax meet;
    }
  </style>
</head>

<body>
  <h1>Scroll Down to See Crystals Break Apart</h1>
  <div class="content">
    <p>This is some placeholder text to create scrollable content. Keep scrolling and watch the crystals at the bottom animate upwards as you go!</p>
  </div>

  <!-- Crystal SVG Container -->
  <div class="crystal-container">
    <svg 
      id="crystal-svg" 
      viewBox="0 0 800 300"
      preserveAspectRatio="xMidYMax meet"
    >
      <!-- Crystal 1 -->
      <polygon 
        id="crystal1"
        points="100,300 120,150 140,200 160,80 180,200 200,150 220,300"
        fill="#6CCFF6"
      />
      <!-- Crystal 2 -->
      <polygon 
        id="crystal2"
        points="250,300 260,120 280,90 300,60 320,90 340,120 350,300"
        fill="#82E0AA"
      />
      <!-- Crystal 3 -->
      <polygon 
        id="crystal3"
        points="390,300 410,220 430,230 450,140 470,230 490,220 510,300"
        fill="#F7DC6F"
      />
      <!-- Crystal 4 -->
      <polygon 
        id="crystal4"
        points="540,300 550,140 570,70 590,100 610,70 630,140 640,300"
        fill="#F1948A"
      />
      <!-- Crystal 5 -->
      <polygon 
        id="crystal5"
        points="670,300 680,130 700,100 720,40 740,100 760,130 770,300"
        fill="#D7BDE2"
      />
    </svg>
  </div>

  <script>
    // Register GSAP plugins
    gsap.registerPlugin(ScrollTrigger);

    // Array of crystal IDs
    const crystals = ["#crystal1", "#crystal2", "#crystal3", "#crystal4", "#crystal5"];

    // Create a timeline linked to scroll
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: document.body, // animate throughout the full page
        start: "top top",
        end: "bottom bottom",
        scrub: true,       // links animation progress to scroll
      }
    });

    // Animate each crystal "breaking" upward with random offsets
    crystals.forEach((selector) => {
      const randX = gsap.utils.random(-40, 40);
      const randY = gsap.utils.random(-150, -300);
      const randRot = gsap.utils.random(-30, 30);

      tl.to(selector, {
        duration: 3,
        x: randX,
        y: randY,
        rotation: randRot,
        transformOrigin: "50% 100%", // pivot from bottom center
        ease: "power2.inOut"
      }, 0); // Start all at timeline position 0
    });

    // Optionally fade them out near the end
    tl.to(crystals, {
      duration: 1.5,
      opacity: 0
    }, ">-0.5"); // start fade near the end
  </script>
</body>
</html>